{"pageContext":{"isCreatedByStatefulCreatePages":false,"notebook":"AWS","section":"DevOps","page":{"id":"0-45ea17b4d1222342848798a0f8b2d070!1-BC575AB8E2AB9833!2167","self":"https://www.onenote.com/api/v1.0/me/notes/pages/0-45ea17b4d1222342848798a0f8b2d070!1-BC575AB8E2AB9833!2167","createdTime":"2018-01-24T12:38:05.687Z","title":"AWS CodePipeline Troubleshoot-1","createdByAppId":"","links":{"oneNoteEmbedUrl":{"href":"https://onedrive.live.com/redir.aspx?cid=bc575ab8e2ab9833&page=edit&resid=BC575AB8E2AB9833!2000&parId=BC575AB8E2AB9833!109&wd=target%28DevOps.one%7C67972506-f6b4-244e-b3cc-e3ad9db1d8e9%2FAWS%20CodePipeline%20Troubleshoot-1%7C58f79da5-5357-7043-bd87-241ed3228909%2F%29"},"oneNoteClientUrl":{"href":"onenote:https://d.docs.live.net/bc575ab8e2ab9833/Documents/AWS/DevOps.one#AWS%20CodePipeline%20Troubleshoot-1&section-id=67972506-f6b4-244e-b3cc-e3ad9db1d8e9&page-id=58f79da5-5357-7043-bd87-241ed3228909&end"},"oneNoteWebUrl":{"href":"https://onedrive.live.com/redir.aspx?cid=bc575ab8e2ab9833&page=edit&resid=BC575AB8E2AB9833!2000&parId=BC575AB8E2AB9833!109&wd=target%28DevOps.one%7C67972506-f6b4-244e-b3cc-e3ad9db1d8e9%2FAWS%20CodePipeline%20Troubleshoot-1%7C58f79da5-5357-7043-bd87-241ed3228909%2F%29"}},"contentUrl":"https://www.onenote.com/api/v1.0/me/notes/pages/0-45ea17b4d1222342848798a0f8b2d070!1-BC575AB8E2AB9833!2167/content","lastModifiedTime":"2018-12-12T04:38:06Z","parentSection@odata.context":"https://www.onenote.com/api/v1.0/$metadata#me/notes/sections('0-BC575AB8E2AB9833%212167')/pages('0-45ea17b4d1222342848798a0f8b2d070%211-BC575AB8E2AB9833%212167')/parentSection(id,name,self)/$entity","parentSection":{"id":"0-BC575AB8E2AB9833!2167","name":"DevOps","self":"https://www.onenote.com/api/v1.0/me/notes/sections/0-BC575AB8E2AB9833!2167"},"content":"       에러    Error while executing command: aws cloudformation package --template-file template.yaml --s3-bucket s3://codepipeline-ap-northeast-2-719488513159 --output-template-file NewSamTemplate.yaml. Reason: exit status 255        Unable to upload artifact ./ referenced by CodeUri parameter of Products resource.    An error occurred (AccessDenied) when calling the PutObject operation: Access Denied        같은 증상 겪는 유저    https://forums.aws.amazon.com/thread.jspa?messageID=794124        조치    The access is denied because of artifact bucket policy DenyUnEncryptedObjectUploads    The problem is solved by using --kms-key-id in buildspec.yml    aws cloudformation package --template-file samTemplate.yaml --kms-key-id <kms-key-id> --s3-bucket <S3 bucket> --output-template-file NewSamTemplate.yaml        Check the --kms-key-id    http://docs.aws.amazon.com/cli/latest/reference/cloudformation/package.html         IAM에서 Encryption keys를 들어가고, CodePipeline 리전을 선택하면 서비스별 Key ID가 나오니까 그것 복붙하면된다.        View Your Default Amazon S3 SSE-KMS Encryption Keys    http://docs.aws.amazon.com/codepipeline/latest/userguide/S3-view-default-keys.html        해결    Aws cloudformation cli에다가 --kms-key-id옵션을 넣어서 해결.       ","html":"\n\t\t<div style=\"position:absolute;left:69px;top:114px;width:555px\">\n\t\t\t<h3 lang=\"ko-KR\" style=\"color:#5b9bd5;margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic\">&#xC5D0;&#xB7EC;</span></h3>\n\t\t\t<p lang=\"ko-KR\" style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic;font-size:10pt\">Error while executing command: aws cloudformation package --template-file template.yaml --s3-bucket s3://codepipeline-ap-northeast-2-719488513159 --output-template-file NewSamTemplate.yaml. Reason: exit status 255</span></p>\n\t\t\t<br>\n\t\t\t<p lang=\"ko-KR\" style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:10pt\">Unable to upload artifact ./ referenced by CodeUri parameter of Products resource.</span></p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:10pt\">An error occurred (AccessDenied) when calling the PutObject operation: Access Denied</span></p>\n\t\t\t<br>\n\t\t\t<h3 lang=\"ko-KR\" style=\"color:#5b9bd5;margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic\">&#xAC19;&#xC740;</span><span lang=\"en-US\"> </span><span style=\"font-family:Malgun Gothic\">&#xC99D;&#xC0C1;</span><span lang=\"en-US\"> </span><span style=\"font-family:Malgun Gothic\">&#xACAA;&#xB294;</span><span lang=\"en-US\"> </span><span style=\"font-family:Malgun Gothic\">&#xC720;&#xC800;</span></h3>\n\t\t\t<p lang=\"ko-KR\" style=\"margin-top:0pt;margin-bottom:0pt\"><a href=\"https://forums.aws.amazon.com/thread.jspa?messageID=794124\">https://forums.aws.amazon.com/thread.jspa?messageID=794124</a></p>\n\t\t\t<br>\n\t\t\t<h3 lang=\"ko-KR\" style=\"color:#5b9bd5;margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic\">&#xC870;&#xCE58;</span></h3>\n\t\t\t<p lang=\"ko-KR\" style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic;font-size:10pt\">The access is denied because of artifact bucket policy DenyUnEncryptedObjectUploads</span></p>\n\t\t\t<p lang=\"ko-KR\" style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic;font-size:10pt\">The problem is solved by using --kms-key-id in buildspec.yml</span></p>\n\t\t\t<p lang=\"ko-KR\" style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic;font-size:10pt\">aws cloudformation package --template-file samTemplate.yaml&#xA0;</span><span style=\"font-family:verdana;font-size:10pt;color:black;background-color:white;font-weight:bold\">--kms-key-id &lt;kms-key-id&gt;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\">&#xA0;--s3-bucket &lt;S3 bucket&gt; --output-template-file NewSamTemplate.yaml</span></p>\n\t\t\t<br>\n\t\t\t<p lang=\"ko-KR\" style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic;font-size:10pt\">Check the --kms-key-id</span></p>\n\t\t\t<p lang=\"ko-KR\" style=\"margin-top:0pt;margin-bottom:0pt\"><a href=\"http://docs.aws.amazon.com/cli/latest/reference/cloudformation/package.html\" style=\"font-family:verdana;font-size:10pt;background-color:white\">http://docs.aws.amazon.com/cli/latest/reference/cloudformation/package.html</a><span style=\"font-family:Malgun Gothic;font-size:10pt\">&#xA0;</span></p>\n\t\t\t<br>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic;font-size:10pt\">IAM</span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic;font-size:10pt\">&#xC5D0;&#xC11C;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\"> Encryption keys</span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic;font-size:10pt\">&#xB97C;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\"> </span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic;font-size:10pt\">&#xB4E4;&#xC5B4;&#xAC00;&#xACE0;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\">, CodePipeline </span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic;font-size:10pt\">&#xB9AC;&#xC804;&#xC744;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\"> </span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic;font-size:10pt\">&#xC120;&#xD0DD;&#xD558;&#xBA74;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\"> </span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic;font-size:10pt\">&#xC11C;&#xBE44;&#xC2A4;&#xBCC4;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\"> Key ID</span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic;font-size:10pt\">&#xAC00;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\"> </span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic;font-size:10pt\">&#xB098;&#xC624;&#xB2C8;&#xAE4C;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\"> </span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic;font-size:10pt\">&#xADF8;&#xAC83;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\"> </span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic;font-size:10pt\">&#xBCF5;&#xBD99;&#xD558;&#xBA74;&#xB41C;&#xB2E4;</span><span style=\"font-family:Malgun Gothic;font-size:10pt\">.</span></p>\n\t\t\t<br>\n\t\t\t<p lang=\"ko-KR\" style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic;font-size:10pt\">View Your Default Amazon S3 SSE-KMS Encryption Keys</span></p>\n\t\t\t<p lang=\"ko-KR\" style=\"margin-top:0pt;margin-bottom:0pt\"><a href=\"http://docs.aws.amazon.com/codepipeline/latest/userguide/S3-view-default-keys.html\" style=\"font-family:verdana;font-size:9pt;background-color:white\">http://docs.aws.amazon.com/codepipeline/latest/userguide/S3-view-default-keys.html</a></p>\n\t\t\t<br>\n\t\t\t<h3 lang=\"ko-KR\" style=\"color:#5b9bd5;margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic\">&#xD574;&#xACB0;</span></h3>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Malgun Gothic\">Aws cloudformation cli</span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic\">&#xC5D0;&#xB2E4;&#xAC00;</span><span style=\"font-family:Malgun Gothic\"> --kms-key-id</span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic\">&#xC635;&#xC158;&#xC744;</span><span style=\"font-family:Malgun Gothic\"> </span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic\">&#xB123;&#xC5B4;&#xC11C;</span><span style=\"font-family:Malgun Gothic\"> </span><span lang=\"ko-KR\" style=\"font-family:Malgun Gothic\">&#xD574;&#xACB0;</span><span style=\"font-family:Malgun Gothic\">.</span></p>\n\t\t</div>\n\t\n\n"}}}