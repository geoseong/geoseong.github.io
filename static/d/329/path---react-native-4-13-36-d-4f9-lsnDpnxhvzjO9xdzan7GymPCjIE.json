{"pageContext":{"notebook":"React-Native","section":"ReactNative[ErrorNote]","page":{"id":"0-82a08910e6d35b4b9cf22060740966d3!1-BC575AB8E2AB9833!2158","self":"https://www.onenote.com/api/v1.0/me/notes/pages/0-82a08910e6d35b4b9cf22060740966d3!1-BC575AB8E2AB9833!2158","createdTime":"2018-01-16T07:40:25Z","title":"[Android] APK 빌드 실패기","createdByAppId":"","links":{"oneNoteEmbedUrl":{"href":"https://onedrive.live.com/redir.aspx?cid=bc575ab8e2ab9833&page=edit&resid=BC575AB8E2AB9833!2149&parId=BC575AB8E2AB9833!109&wd=target%28ReactNative%5BErrorNote%5D.one%7C245a49f3-2cba-0049-bb45-49345040c03b%2F%5BAndroid%5D%20APK%20%EB%B9%8C%EB%93%9C%20%EC%8B%A4%ED%8C%A8%EA%B8%B0%7C32fd54dc-0911-c54d-a29b-0a8ea02e9624%2F%29"},"oneNoteClientUrl":{"href":"onenote:https://d.docs.live.net/bc575ab8e2ab9833/Documents/React-Native/ReactNative%5BErrorNote%5D.one#%5BAndroid%5D%20APK%20%EB%B9%8C%EB%93%9C%20%EC%8B%A4%ED%8C%A8%EA%B8%B0&section-id=245a49f3-2cba-0049-bb45-49345040c03b&page-id=32fd54dc-0911-c54d-a29b-0a8ea02e9624&end"},"oneNoteWebUrl":{"href":"https://onedrive.live.com/redir.aspx?cid=bc575ab8e2ab9833&page=edit&resid=BC575AB8E2AB9833!2149&parId=BC575AB8E2AB9833!109&wd=target%28ReactNative%5BErrorNote%5D.one%7C245a49f3-2cba-0049-bb45-49345040c03b%2F%5BAndroid%5D%20APK%20%EB%B9%8C%EB%93%9C%20%EC%8B%A4%ED%8C%A8%EA%B8%B0%7C32fd54dc-0911-c54d-a29b-0a8ea02e9624%2F%29"}},"contentUrl":"https://www.onenote.com/api/v1.0/me/notes/pages/0-82a08910e6d35b4b9cf22060740966d3!1-BC575AB8E2AB9833!2158/content","lastModifiedTime":"2018-04-16T09:07:49Z","parentSection@odata.context":"https://www.onenote.com/api/v1.0/$metadata#me/notes/sections('0-BC575AB8E2AB9833%212158')/pages('0-82a08910e6d35b4b9cf22060740966d3%211-BC575AB8E2AB9833%212158')/parentSection(id,name,self)/$entity","parentSection":{"id":"0-BC575AB8E2AB9833!2158","name":"ReactNative[ErrorNote]","self":"https://www.onenote.com/api/v1.0/me/notes/sections/0-BC575AB8E2AB9833!2158"},"content":"       어플 실행 시 처음 렌더링도 제대로 안됨         Gradle.properties￼android.useDeprecatedNdk=true 부분 삭제하고 빌드     React-native 서버 실행상태로 curl을 이용해서 bundle 빼냄￼curl \"http://localhost:8081/index.android.bundle?platform=android\" -o \"android/app/src/main/assets/index.android.bundle\"     Android 실행을 release 모드로 해봄￼$ react-native run-android --variant=release     Android Studio 에서 새로 keystore 를 만들고 signed APK 빌드     Node_modules/react-native/react.gradle에 아래 코드 추가     // Added by tspark : to avoid duplicate error when build ./gradlew assembleRelease     doLast {         def moveFunc = { resSuffix ->             File originalDir = file(\"${resourcesDir}/drawable-${resSuffix}\")             if (originalDir.exists()) {                 File destDir = file(\"${resourcesDir}/drawable-${resSuffix}-v4\")                 ant.move(file: originalDir, tofile: destDir)             }         }         moveFunc.curry(\"ldpi\").call()         moveFunc.curry(\"mdpi\").call()         moveFunc.curry(\"hdpi\").call()         moveFunc.curry(\"xhdpi\").call()         moveFunc.curry(\"xxhdpi\").call()         moveFunc.curry(\"xxxhdpi\").call()     }     TabViewAnimated의 _renderScene 리턴클래스를 PureComponent 코딩      Android/app/build.gradle의 universalApk 를 false -> true로 변경         splits {             abi {                 reset()                 enable enableSeparateBuildPerCPUArchitecture                 universalApk true  // If true, also generate a universal APK                 include \"armeabi-v7a\", \"x86\"             }         }            렌더링 성공.        ImagePicker실행하는 데 1~2분 소요, 음성인식 시작 시 freezing -> 결국 out of memory         AndroidManifest.xml 에서 android:largeHeap=\"true\" 삽입     Android Device Monitor에서 힙메모리 확인한 상황     Heap Size가 1기가정도 늘었지만 증상은 여전함                 ImagePicker실행하는 데에는 성공. 음성인식 시작 시 아무런 반응이 없다가 아무런 메시지도 안뜨고 앱 종료 메시지만 나옴                 AndroidManifest.xml 에 android:hardwareAccelerated=\"true\" 삽입     AndroidManifest.xml 에 <uses-permission android:name=\"android.permission.RECORD_AUDIO\"/> 삽입     새로운 프로젝트를 파서 그곳에다가 코드를 옮겼고, 렌더링 부분에 필요없는 <View>는 걷어냈다. 그러니까 잘됨.           ","html":"\n\t\t<div style=\"position:absolute;left:48px;top:139px;width:564px\">\n\t\t\t<h3 style=\"font-size:12pt;color:#5b9bd5;margin-top:0pt;margin-bottom:0pt\">&#xC5B4;&#xD50C;<span lang=\"en-US\"> </span>&#xC2E4;&#xD589;<span lang=\"en-US\"> </span>&#xC2DC;<span lang=\"en-US\"> </span>&#xCC98;&#xC74C;<span lang=\"en-US\"> </span>&#xB80C;&#xB354;&#xB9C1;&#xB3C4;<span lang=\"en-US\"> </span>&#xC81C;&#xB300;&#xB85C;<span lang=\"en-US\"> </span>&#xC548;&#xB428;</h3>\n\t\t\t<ol>\n\t\t\t\t<li><span lang=\"en-US\"><span style=\"font-weight:bold\">Gradle.properties</span>&#xFFFC;android.useDeprecatedNdk=true <span lang=\"ko-KR\">&#xBD80;&#xBD84;</span> <span lang=\"ko-KR\">&#xC0AD;&#xC81C;&#xD558;&#xACE0;</span> <span lang=\"ko-KR\">&#xBE4C;&#xB4DC;</span></span></li>\n\t\t\t\t<li><span lang=\"en-US\"><span style=\"font-weight:bold\">React-native </span><span lang=\"ko-KR\" style=\"font-weight:bold\">&#xC11C;&#xBC84;</span><span style=\"font-weight:bold\"> </span><span lang=\"ko-KR\" style=\"font-weight:bold\">&#xC2E4;&#xD589;&#xC0C1;&#xD0DC;&#xB85C;</span><span style=\"font-weight:bold\"> curl</span><span lang=\"ko-KR\" style=\"font-weight:bold\">&#xC744;</span><span style=\"font-weight:bold\"> </span><span lang=\"ko-KR\" style=\"font-weight:bold\">&#xC774;&#xC6A9;&#xD574;&#xC11C;</span><span style=\"font-weight:bold\"> bundle </span><span lang=\"ko-KR\" style=\"font-weight:bold\">&#xBE7C;&#xB0C4;</span><span lang=\"ko-KR\">&#xFFFC;</span><span lang=\"ko-KR\">curl &quot;</span><a href=\"http://localhost:8081/index.android.bundle?platform=android\" lang=\"ko-KR\">http://localhost:8081/index.android.bundle?platform=android</a><span lang=\"ko-KR\">&quot; -o &quot;android/app/src/main/assets/index.android.bundle&quot;</span></span></li>\n\t\t\t\t<li><span lang=\"en-US\"><span style=\"font-weight:bold\">Android </span><span lang=\"ko-KR\" style=\"font-weight:bold\">&#xC2E4;&#xD589;&#xC744;</span><span style=\"font-weight:bold\"> release </span><span lang=\"ko-KR\" style=\"font-weight:bold\">&#xBAA8;&#xB4DC;&#xB85C;</span><span style=\"font-weight:bold\"> </span><span lang=\"ko-KR\" style=\"font-weight:bold\">&#xD574;&#xBD04;</span>&#xFFFC;$ react-native run-android --variant=release</span></li>\n\t\t\t\t<li><span lang=\"en-US\">Android Studio <span lang=\"ko-KR\">&#xC5D0;&#xC11C;</span> <span lang=\"ko-KR\">&#xC0C8;&#xB85C;</span> keystore <span lang=\"ko-KR\">&#xB97C;</span> <span lang=\"ko-KR\">&#xB9CC;&#xB4E4;&#xACE0;</span> signed APK <span lang=\"ko-KR\">&#xBE4C;&#xB4DC;</span></span></li>\n\t\t\t\t<li><span lang=\"en-US\">Node_modules/react-native/react.gradle<span lang=\"ko-KR\">&#xC5D0;</span> <span lang=\"ko-KR\">&#xC544;&#xB798;</span> <span lang=\"ko-KR\">&#xCF54;&#xB4DC;</span> <span lang=\"ko-KR\">&#xCD94;&#xAC00;</span></span></li>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">// Added by tspark : to avoid duplicate error when build ./gradlew assembleRelease</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">doLast {</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">    def moveFunc = { resSuffix -&gt;</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">        File originalDir = file(&quot;${resourcesDir}/drawable-${resSuffix}&quot;)</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">        if (originalDir.exists()) {</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">            File destDir = file(&quot;${resourcesDir}/drawable-${resSuffix}-v4&quot;)</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">            ant.move(file: originalDir, tofile: destDir)</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">        }</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">    }</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">    moveFunc.curry(&quot;ldpi&quot;).call()</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">    moveFunc.curry(&quot;mdpi&quot;).call()</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">    moveFunc.curry(&quot;hdpi&quot;).call()</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">    moveFunc.curry(&quot;xhdpi&quot;).call()</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">    moveFunc.curry(&quot;xxhdpi&quot;).call()</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">    moveFunc.curry(&quot;xxxhdpi&quot;).call()</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:9pt\">}</span></p>\n\t\t\t\t<li><span lang=\"en-US\">TabViewAnimated<span lang=\"ko-KR\">&#xC758;</span> _renderScene <span lang=\"ko-KR\">&#xB9AC;&#xD134;&#xD074;&#xB798;&#xC2A4;&#xB97C;</span> PureComponent <span lang=\"ko-KR\">&#xCF54;&#xB529;</span> </span></li>\n\t\t\t\t<li><span lang=\"en-US\">Android/app/build.gradle<span lang=\"ko-KR\">&#xC758;</span> universalApk <span lang=\"ko-KR\">&#xB97C;</span> false -&gt; true<span lang=\"ko-KR\">&#xB85C;</span> <span lang=\"ko-KR\">&#xBCC0;&#xACBD;</span></span></li>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">   <span style=\"font-size:10pt\"> splits {</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:10pt\">        abi {</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:10pt\">            reset()</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:10pt\">            enable enableSeparateBuildPerCPUArchitecture</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:10pt\">            </span><span style=\"font-size:10pt;color:#0432ff;font-weight:bold;text-decoration:underline\">universalApk true</span><span style=\"font-size:10pt\">  // If true, also generate a universal APK</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:10pt\">            include &quot;armeabi-v7a&quot;, &quot;x86&quot;</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:10pt\">        }</span></p>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:10pt\">    }</span></p>\n\t\t\t</ol>\n\t\t\t<br>\n\t\t\t<h3 style=\"font-size:12pt;color:#5b9bd5;margin-top:0pt;margin-bottom:0pt\">&#xB80C;&#xB354;&#xB9C1;<span lang=\"en-US\"> </span>&#xC131;&#xACF5;<span lang=\"en-US\">.</span></h3>\n\t\t\t<br>\n\t\t\t<h3 lang=\"en-US\" style=\"font-size:12pt;color:#5b9bd5;margin-top:0pt;margin-bottom:0pt\">ImagePicker<span lang=\"ko-KR\">&#xC2E4;&#xD589;&#xD558;&#xB294;</span> <span lang=\"ko-KR\">&#xB370;</span> 1~2<span lang=\"ko-KR\">&#xBD84;</span> <span lang=\"ko-KR\">&#xC18C;&#xC694;</span>, <span lang=\"ko-KR\">&#xC74C;&#xC131;&#xC778;&#xC2DD;</span> <span lang=\"ko-KR\">&#xC2DC;&#xC791;</span> <span lang=\"ko-KR\">&#xC2DC;</span> freezing -&gt; <span lang=\"ko-KR\">&#xACB0;&#xAD6D;</span> out of memory</h3>\n\t\t\t<ol>\n\t\t\t\t<li value=\"7\"><span lang=\"en-US\">AndroidManifest.xml <span lang=\"ko-KR\">&#xC5D0;&#xC11C;</span> <span style=\"font-weight:bold\">android:largeHeap=&quot;true&quot;</span> <span lang=\"ko-KR\">&#xC0BD;&#xC785;</span></span></li>\n\t\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">A<span lang=\"en-US\">ndroid Device Monitor</span>&#xC5D0;&#xC11C;<span lang=\"en-US\"> </span>&#xD799;&#xBA54;&#xBAA8;&#xB9AC;<span lang=\"en-US\"> </span>&#xD655;&#xC778;&#xD55C;<span lang=\"en-US\"> </span>&#xC0C1;&#xD669;</p>\n\t\t\t\t<p lang=\"en-US\" style=\"margin-top:0pt;margin-bottom:0pt\">Heap Size<span lang=\"ko-KR\">&#xAC00;</span> 1<span lang=\"ko-KR\">&#xAE30;&#xAC00;&#xC815;&#xB3C4;</span> <span lang=\"ko-KR\">&#xB298;&#xC5C8;&#xC9C0;&#xB9CC;</span> <span lang=\"ko-KR\">&#xC99D;&#xC0C1;&#xC740;</span> <span lang=\"ko-KR\">&#xC5EC;&#xC804;&#xD568;</span></p>\n\t\t\t\t<img alt=\"Heap updates will happen after every GC for this client \nID \nHeap Size \n9.532 MB \nAllocated \n5.541 MB \nFree % IJsed \n3.991 MB 58.13% \n# Object! \n38,92C \" width=\"480\" height=\"79\" src=\"https://www.onenote.com/api/v1.0/me/notes/resources/0-f98c002054b42548b680dbf5fba95385!1-BC575AB8E2AB9833!2158/content?publicAuth=true&amp;mimeType=image/png\" data-src-type=\"image/png\" data-fullres-src=\"https://www.onenote.com/api/v1.0/me/notes/resources/0-f98c002054b42548b680dbf5fba95385!1-BC575AB8E2AB9833!2158/content?publicAuth=true&amp;mimeType=image/png\" data-fullres-src-type=\"image/png\">\n\t\t\t</ol>\n\t\t\t<br>\n\t\t\t<h3 lang=\"en-US\" style=\"font-size:12pt;color:#5b9bd5;margin-top:0pt;margin-bottom:0pt\">ImagePicker<span lang=\"ko-KR\">&#xC2E4;&#xD589;&#xD558;&#xB294;</span> <span lang=\"ko-KR\">&#xB370;&#xC5D0;&#xB294;</span> <span lang=\"ko-KR\">&#xC131;&#xACF5;</span>. <span lang=\"ko-KR\">&#xC74C;&#xC131;&#xC778;&#xC2DD;</span> <span lang=\"ko-KR\">&#xC2DC;&#xC791;</span> <span lang=\"ko-KR\">&#xC2DC;</span> <span lang=\"ko-KR\">&#xC544;&#xBB34;&#xB7F0;</span> <span lang=\"ko-KR\">&#xBC18;&#xC751;&#xC774;</span> <span lang=\"ko-KR\">&#xC5C6;&#xB2E4;&#xAC00;</span> <span lang=\"ko-KR\">&#xC544;&#xBB34;&#xB7F0;</span> <span lang=\"ko-KR\">&#xBA54;&#xC2DC;&#xC9C0;&#xB3C4;</span> <span lang=\"ko-KR\">&#xC548;&#xB728;&#xACE0;</span> <span lang=\"ko-KR\">&#xC571;</span> <span lang=\"ko-KR\">&#xC885;&#xB8CC;</span> <span lang=\"ko-KR\">&#xBA54;&#xC2DC;&#xC9C0;&#xB9CC;</span> <span lang=\"ko-KR\">&#xB098;&#xC634;</span></h3>\n\t\t\t<img width=\"283.5\" height=\"136\" src=\"https://www.onenote.com/api/v1.0/me/notes/resources/0-c8accdaa8cb90a439946ded4cc2c29ab!1-BC575AB8E2AB9833!2158/content?publicAuth=true&amp;mimeType=image/png\" data-src-type=\"image/png\" data-fullres-src=\"https://www.onenote.com/api/v1.0/me/notes/resources/0-c8accdaa8cb90a439946ded4cc2c29ab!1-BC575AB8E2AB9833!2158/content?publicAuth=true&amp;mimeType=image/png\" data-fullres-src-type=\"image/png\">\n\t\t\t<br>\n\t\t\t<ol>\n\t\t\t\t<li value=\"8\"><span lang=\"en-US\">AndroidManifest.xml <span lang=\"ko-KR\">&#xC5D0;</span><span style=\"font-weight:bold\"> </span><span lang=\"ko-KR\" style=\"font-weight:bold\">android:hardwareAccelerated=&quot;true&quot;</span> <span lang=\"ko-KR\">&#xC0BD;&#xC785;</span></span></li>\n\t\t\t\t<li><span lang=\"en-US\">AndroidManifest.xml <span lang=\"ko-KR\">&#xC5D0;</span><span style=\"font-weight:bold\"> </span><span lang=\"ko-KR\" style=\"font-weight:bold\">&lt;uses-permission android:name=&quot;android.permission.RECORD_AUDIO&quot;/&gt;</span> <span lang=\"ko-KR\">&#xC0BD;&#xC785;</span></span></li>\n\t\t\t\t<li>&#xC0C8;&#xB85C;&#xC6B4;<span lang=\"en-US\"> </span>&#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C;<span lang=\"en-US\"> </span>&#xD30C;&#xC11C;<span lang=\"en-US\"> </span>&#xADF8;&#xACF3;&#xC5D0;&#xB2E4;&#xAC00;<span lang=\"en-US\"> </span>&#xCF54;&#xB4DC;&#xB97C;<span lang=\"en-US\"> </span>&#xC62E;&#xACBC;&#xACE0;<span lang=\"en-US\">, </span>&#xB80C;&#xB354;&#xB9C1;<span lang=\"en-US\"> </span>&#xBD80;&#xBD84;&#xC5D0;<span lang=\"en-US\"> </span>&#xD544;&#xC694;&#xC5C6;&#xB294;<span lang=\"en-US\"> &lt;View&gt;</span>&#xB294;<span lang=\"en-US\"> </span>&#xAC77;&#xC5B4;&#xB0C8;&#xB2E4;<span lang=\"en-US\">. </span>&#xADF8;&#xB7EC;&#xB2C8;&#xAE4C;<span lang=\"en-US\"> </span>&#xC798;&#xB428;<span lang=\"en-US\">.</span></li>\n\t\t\t</ol>\n\t\t</div>\n\t\n\n"}}}