{"pageContext":{"isCreatedByStatefulCreatePages":false,"notebook":"AWS","section":"AWS EC2","page":{"id":"0-f4837363c306184ba7cae9b4e823ff83!1-BC575AB8E2AB9833!2011","self":"https://www.onenote.com/api/v1.0/me/notes/pages/0-f4837363c306184ba7cae9b4e823ff83!1-BC575AB8E2AB9833!2011","createdTime":"2017-09-04T06:39:00Z","title":"EC2 Bootstrapping 테스트","createdByAppId":"","links":{"oneNoteEmbedUrl":{"href":"https://onedrive.live.com/redir.aspx?cid=bc575ab8e2ab9833&page=edit&resid=BC575AB8E2AB9833!2000&parId=BC575AB8E2AB9833!109&wd=target%28AWS%20EC2.one%7Ca9db5ec1-48b3-a24e-bc07-98d85a74ce00%2FEC2%20Bootstrapping%20%ED%85%8C%EC%8A%A4%ED%8A%B8%7C764aea38-3751-004e-a888-5e84bad09bef%2F%29"},"oneNoteClientUrl":{"href":"onenote:https://d.docs.live.net/bc575ab8e2ab9833/Documents/AWS/AWS%20EC2.one#EC2%20Bootstrapping%20%ED%85%8C%EC%8A%A4%ED%8A%B8&section-id=a9db5ec1-48b3-a24e-bc07-98d85a74ce00&page-id=764aea38-3751-004e-a888-5e84bad09bef&end"},"oneNoteWebUrl":{"href":"https://onedrive.live.com/redir.aspx?cid=bc575ab8e2ab9833&page=edit&resid=BC575AB8E2AB9833!2000&parId=BC575AB8E2AB9833!109&wd=target%28AWS%20EC2.one%7Ca9db5ec1-48b3-a24e-bc07-98d85a74ce00%2FEC2%20Bootstrapping%20%ED%85%8C%EC%8A%A4%ED%8A%B8%7C764aea38-3751-004e-a888-5e84bad09bef%2F%29"}},"contentUrl":"https://www.onenote.com/api/v1.0/me/notes/pages/0-f4837363c306184ba7cae9b4e823ff83!1-BC575AB8E2AB9833!2011/content","lastModifiedTime":"2017-10-14T11:46:29Z","parentSection@odata.context":"https://www.onenote.com/api/v1.0/$metadata#me/notes/sections('0-BC575AB8E2AB9833%212011')/pages('0-f4837363c306184ba7cae9b4e823ff83%211-BC575AB8E2AB9833%212011')/parentSection(id,name,self)/$entity","parentSection":{"id":"0-BC575AB8E2AB9833!2011","name":"AWS EC2","self":"https://www.onenote.com/api/v1.0/me/notes/sections/0-BC575AB8E2AB9833!2011"},"content":"           EC2 Bootstrapping 목적    1.Git pull    2.Pm2 start (Not God daemon) => 일반유저들 ( ec2-user || root ) pm2 list로 볼 수 있게..        테스트    curl -X GET http://52.79.199.75:8000/board/read    curl -X PUT http://52.79.199.75:8000/board/modify        ssh접속    ssh -i /Users/taeseongpark/Documents/Study/AWS/EC2/pem/geoseong_vpc.pem ec2-user@        ps aux|grep pm2    [root@ip-172-31-14-68 ec2-user]# ps aux|grep pm2    root      2681  0.1  3.2 916140 33204 ?        Ssl  05:50   0:00 PM2 v2.6.1: God Daemon (/root/.pm2)             root      3111  0.0  0.2 110456  2108 pts/0    S+   05:57   0:00 grep --color=auto pm2        root상에서 pm2 list 보기    sudo -i pm2 list    •sudo -i : Gives you a root prompt with a new shell environment (as if root did a login). Does a cd to root's home directory as well.        시도 1 - 52.79.162.59    로그파일 : /Users/taeseongpark/Documents/Study/AWS/EC2/log/dump_pm2_170904    #!/bin/bash    cd /home/ec2-user/Node.js-Test    sudo git pull origin master    sudo pkill -f PM2    pm2 startup systemv -u ec2-user --hp /home/ec2-user    pm2 start —no-daemon /home/ec2-user/Node.js-Test/app.js    pm2 save        시도 2 - 13.124.204.133 ( root에서 pm2 시작 확인. )    로그파일 : /Users/taeseongpark/Documents/Study/AWS/EC2/log/dump_pm2_sudo_170904    #!/bin/bash    cd /home/ec2-user/Node.js-Test    sudo git pull origin master    sudo pkill -f PM2    pm2 startup systemv -u ec2-user --hp /home/ec2-user    sudo pm2 start /home/ec2-user/Node.js-Test/app.js    pm2 save        시도 3 - 52.79.199.75    ✓root에서 pm2 list 보이는지    ✓EC2 수동 reboot에도 pm2 start 되는지    ✓Pm2 kill 이후 reboot했는데 pm2 start가 되는지.    #!/bin/bash    cd /home/ec2-user/Node.js-Test    sudo git pull origin master    sudo pkill -f PM2    sudo pm2 start /home/ec2-user/Node.js-Test/app.js    sudo pm2 startup    sudo pm2 save       ","html":"\n\t\t<div style=\"position:absolute;left:48px;top:163px;width:628px\">\n\t\t\t<br>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">EC2 Bootstrapping &#xBAA9;&#xC801;</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">1.Git pull</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">2.Pm2 start (Not God daemon) =&gt; &#xC77C;&#xBC18;&#xC720;&#xC800;&#xB4E4; ( ec2-user || root ) pm2 list&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xAC8C;..</p>\n\t\t\t<br>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">&#xD14C;&#xC2A4;&#xD2B8;</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">curl -X GET <a href=\"http://52.79.199.75:8000/board/read\">http://52.79.199.75:8000/board/read</a></p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">curl -X PUT <a href=\"http://52.79.199.75:8000/board/modify\">http://52.79.199.75:8000/board/modify</a></p>\n\t\t\t<br>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">ssh&#xC811;&#xC18D;</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">ssh -i /Users/taeseongpark/Documents/Study/AWS/EC2/pem/geoseong_vpc.pem ec2-user@</p>\n\t\t\t<br>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">ps aux|grep pm2</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">[root@ip-172-31-14-68 ec2-user]# ps aux|grep pm2</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">root      2681  0.1  3.2 916140 33204 ?        Ssl  05:50   0:00 PM2 v2.6.1: God Daemon (/root/.pm2)         </p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">root      3111  0.0  0.2 110456  2108 pts/0    S+   05:57   0:00 grep --color=auto pm2</p>\n\t\t\t<br>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">root&#xC0C1;&#xC5D0;&#xC11C; pm2 list &#xBCF4;&#xAE30;</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">sudo -i pm2 list</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">&#x2022;sudo -i : Gives you a root prompt with a new shell environment (as if root did a login). Does a&#xA0;cd&#xA0;to root&apos;s home directory as well.</p>\n\t\t\t<br>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">&#xC2DC;&#xB3C4; 1 - 52.79.162.59</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">&#xB85C;&#xADF8;&#xD30C;&#xC77C; : /Users/taeseongpark/Documents/Study/AWS/EC2/log/dump_pm2_170904</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">#!/bin/bash</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">cd /home/ec2-user/Node.js-Test</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">sudo git pull origin master</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">sudo pkill -f PM2</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">pm2 startup systemv -u ec2-user --hp /home/ec2-user</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">pm2 start &#x2014;no-daemon /home/ec2-user/Node.js-Test/app.js</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">pm2 save</p>\n\t\t\t<br>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">&#xC2DC;&#xB3C4; 2 - 13.124.204.133 ( root&#xC5D0;&#xC11C; pm2 &#xC2DC;&#xC791; &#xD655;&#xC778;. )</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">&#xB85C;&#xADF8;&#xD30C;&#xC77C; : /Users/taeseongpark/Documents/Study/AWS/EC2/log/dump_pm2_sudo_170904</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">#!/bin/bash</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">cd /home/ec2-user/Node.js-Test</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">sudo git pull origin master</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">sudo pkill -f PM2</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">pm2 startup systemv -u ec2-user --hp /home/ec2-user</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">sudo pm2 start /home/ec2-user/Node.js-Test/app.js</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">pm2 save</p>\n\t\t\t<br>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\">&#xC2DC;&#xB3C4; 3 - 52.79.199.75</p>\n\t\t\t<p style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Segoe UI Symbol\">&#x2713;</span><span lang=\"en-US\">root</span><span lang=\"en-US\">&#xC5D0;&#xC11C; pm2 list &#xBCF4;&#xC774;&#xB294;&#xC9C0;</span></p>\n\t\t\t<p lang=\"en-US\" style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Segoe UI Symbol\">&#x2713;</span>EC2 &#xC218;&#xB3D9; reboot&#xC5D0;&#xB3C4; pm2 start &#xB418;&#xB294;&#xC9C0;</p>\n\t\t\t<p lang=\"en-US\" style=\"margin-top:0pt;margin-bottom:0pt\"><span style=\"font-family:Segoe UI Symbol\">&#x2713;</span>Pm2 kill &#xC774;&#xD6C4; reboot&#xD588;&#xB294;&#xB370; pm2 start&#xAC00; &#xB418;&#xB294;&#xC9C0;.</p>\n\t\t\t<p lang=\"en-US\" style=\"margin-top:0pt;margin-bottom:0pt\">#!/bin/bash</p>\n\t\t\t<p lang=\"en-US\" style=\"margin-top:0pt;margin-bottom:0pt\">cd /home/ec2-user/Node.js-Test</p>\n\t\t\t<p lang=\"en-US\" style=\"margin-top:0pt;margin-bottom:0pt\">sudo git pull origin master</p>\n\t\t\t<p lang=\"en-US\" style=\"margin-top:0pt;margin-bottom:0pt\">sudo pkill -f PM2</p>\n\t\t\t<p lang=\"en-US\" style=\"margin-top:0pt;margin-bottom:0pt\">sudo pm2 start /home/ec2-user/Node.js-Test/app.js</p>\n\t\t\t<p lang=\"en-US\" style=\"margin-top:0pt;margin-bottom:0pt\">sudo pm2 startup</p>\n\t\t\t<p lang=\"en-US\" style=\"margin-top:0pt;margin-bottom:0pt\">sudo pm2 save</p>\n\t\t</div>\n\t\n\n"}}}